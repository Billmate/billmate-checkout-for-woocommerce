{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/assets/js/bco-checkout.js"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uE;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,oEAAoE;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,qHAAqH;AACrH;AACA;AACA;AACA,IAAI,8HAA8H;AAClI;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,+BAA+B;AAC/B,6BAA6B;AAC7B;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,gCAAgC;AAChC,8BAA8B;AAC9B;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,iBAAiB;AAChC,oDAAoD;;AAEpD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,I;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,uIAAuI;AACvI;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,CAAC,E","file":"bco-checkout.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/assets/js/bco-checkout.js\");\n","jQuery(function($) {\n\tconst bco_wc = {\n\n\t\tupdate: function() {\n\t\t\t/**\n\t\t\t * Refresh checkout in iframe\n\t\t\t * In this example the name of iframe that contain Qvickly Checkout have the name checkout_iframe\n\t\t\t */\n\t\t\tcheckout_iframe.postMessage('update', '*');\n\t\t},\n\n\t\tlock: function() {\n\t\t\t/**\n\t\t\t * Lock Qvickly checkout from customer interactions\n\t\t\t * Will display loading animation and is used when the store is working on the order, for example when cart is updated\n\t\t\t */\n\t\t\tcheckout_iframe.postMessage('lock', '*');\n\t\t},\n\n\t\tunlock: function() {\n\t\t\t/**\n\t\t\t * If checkout is locked, remove loading animation and customer can continue to interact with Qvickly Checkout\n\t\t\t * Is used when store is done with work that affect the order and Qvickly Checkout, for example when cart is updated\n\t\t\t */\n\t\t\tcheckout_iframe.postMessage('unlock', '*');\n\t\t},\n\n\t\tpurchase_complete: function() {\n\t\t\t/**\n\t\t\t * Post back a reply to the purchase_initialized JS callback. \n\t\t\t * WooCommerce order was successfully created, now let Qvickly complete the purchase.\n\t\t\t * The name of iframe that contain Qvickly Checkout have the name checkout_iframe\n\t\t\t */\n\t\t\tconsole.log('purchase_complete');\n\t\t\tcheckout_iframe.postMessage('purchase_complete', '*');\n\t\t},\n\t\thide_overlay: function() {\n\t\t\t/**\n\t\t\t * Enable Woocommerce order review when overlay is closed in BCO.\n\t\t\t */\n\t\t\tconsole.log('hide_overlay');\n\t\t\t$('#bco-wrapper').removeClass( 'processing' ).unblock();\n\t\t},\n\n\t\thandleEvent: function(event) {\n\t\t\tif(event.origin != \"\") {\n\t\t\t\ttry {\n\t\t\t\t\tvar json = JSON.parse(event.data);\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tswitch (json.event) {\n\t\t\t\t\tcase 'purchase_initialized':\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * When an end user clicks on the \"Purchase button\".\n\t\t\t\t\t\t */\n\t\t\t\t\t\tconsole.log('billmate_purchase_initialized');\n\t\t\t\t\t\tbco_wc.logToFile( 'purchase_initialized from Qvickly triggered' );\n\t\t\t\t\t\tbco_wc.getBillmateCheckout();\n\n\t\t\t\t\t\t$( 'body' ).on( 'bco_order_validation', function( event, bool ) {\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif ( true === bool ) {\n\t\t\t\t\t\t\t\t// Success.\n\t\t\t\t\t\t\t\tbco_wc.purchase_complete();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Fail.\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'address_selected':\n\t\t\t\t\t\tif ( 'checkout' !== bco_wc_params.checkout_flow ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Don't update customer data in Woo if disabled via filter.\n\t\t\t\t\t\tif( 'no' === bco_wc_params.populate_address_fields ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar shippingZip = '';\n\t\t\t\t\t\tvar shippingCountry = '';\n\n\t\t\t\t\t\t// Check if Shipping address is set.\n\t\t\t\t\t\tif ( typeof json.data.Customer.Shipping === 'object' && 'zip' in json.data.Customer.Shipping && '' !== json.data.Customer.Shipping.zip ) {\n\t\t\t\t\t\t\t// Set shipping zip and country.\n\t\t\t\t\t\t\tshippingZip = json.data.Customer.Shipping.zip;\n\t\t\t\t\t\t\tshippingCountry = json.data.Customer.Shipping.country;\n\t\t\t\t\t\t\tbco_wc.addressData.shippingAddress = json.data.Customer.Shipping;\n\n\t\t\t\t\t\t\tbillingAddress = bco_wc.setBillingAddress(json.data);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif ( bco_wc.addressData.shippingZip === shippingZip ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbco_wc.addressData.updateNeeded = 'yes';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbillingAddress = bco_wc.setBillingAddress(json.data);\n\t\t\t\t\t\t\tshippingZip = billingAddress.billingZip;\n\t\t\t\t\t\t\tshippingCountry = billingAddress.billingCountry;\n\n\t\t\t\t\t\t\tif ( bco_wc.addressData.billingZip === billingAddress.billingZip ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbco_wc.addressData.updateNeeded = 'yes';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbco_wc.addressData.billingZip = billingAddress.billingZip;\n\t\t\t\t\t\tbco_wc.addressData.billingCountry = billingAddress.billingCountry;\n\t\t\t\t\t\tbco_wc.addressData.shippingZip = shippingZip;\n\t\t\t\t\t\tbco_wc.addressData.shippingCountry = shippingCountry;\n\n\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * Customer adress have been set or updated\n\t\t\t\t\t\t */\n\t\t\t\t\t\t$('#jsLog').append('address_selected<br />');\n\n\t\t\t\t\t\tif ( 'yes' === bco_wc.addressData.updateNeeded ) {\n\t\t\t\t\t\t\t$( '.woocommerce-checkout-review-order-table' ).block({\n\t\t\t\t\t\t\t\tmessage: null,\n\t\t\t\t\t\t\t\toverlayCSS: {\n\t\t\t\t\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\t\t\t\t\topacity: 0.6\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t$.ajax(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\turl: bco_wc_params.iframe_shipping_address_change_url,\n\t\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\taddress: bco_wc.addressData,\n\t\t\t\t\t\t\t\t\t\tnonce: bco_wc_params.iframe_shipping_address_change_nonce\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\t\t\t\t\t\tbco_wc.setCustomerData(response.data);\n\t\t\t\t\t\t\t\t\t\t// All good trigger update_checkout event.\n\t\t\t\t\t\t\t\t\t\t$( 'body' ).trigger( 'update_checkout' );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\terror: function( response ) {\n\t\t\t\t\t\t\t\t\t\tconsole.log( response );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tcomplete: function() {\n\t\t\t\t\t\t\t\t\t\tbco_wc.shippingUpdated = true;\n\t\t\t\t\t\t\t\t\t\t$( '.woocommerce-checkout-review-order-table' ).unblock();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'payment_method_selected':\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * Payment method is selected\n\t\t\t\t\t\t */\n\t\t\t\t\t\t$('#jsLog').append('payment_method_selected<br />');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'checkout_success':\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * Order is paid and customer are not already redirected to accepturl\n\t\t\t\t\t\t * Store decideds what to do with order and if redirect customer\n\t\t\t\t\t\t */\n\t\t\t\t\t\t$('#jsLog').append('checkout_success<br />');\n\t\t\t\t\t\tif ( 'checkout' === bco_wc_params.checkout_flow ) {\n\t\t\t\t\t\t\tvar redirectUrl = sessionStorage.getItem( 'billmateRedirectUrl' );\n\t\t\t\t\t\t\tconsole.log(redirectUrl);\n\t\t\t\t\t\t\tif( redirectUrl ) {\n\t\t\t\t\t\t\t\twindow.location.href = redirectUrl;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$.ajax(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\turl: bco_wc_params.checkout_success_url,\n\t\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tnonce: bco_wc_params.checkout_success_nonce\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsuccess: function() {\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\terror: function() {\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tcomplete: function( data ) {\n\t\t\t\t\t\t\t\t\t\twindow.location.href = data.responseJSON.data.bco_wc_received_url;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'content_height':\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * The height of checkout, parent can use height to set iframe height when height changes\n\t\t\t\t\t\t */\n\t\t\t\t\t\t$(document).find('#checkout').height(json.data);\n\t\t\t\t\t\t$('#jsLog').append('content_height: ' + json.data + '<br />');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'content_scroll_position':\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * When checkout iframe page is scrolled \n\t\t\t\t\t\t * If iframe have same height as Qvickly Checkout the store can do the scrolling\n\t\t\t\t\t\t * Only scroll to checkout if enabled in settings.\n\t\t\t\t\t\t */\n\t\t\t\t\t\tif( 'no' === bco_wc_params.disable_scroll_to_checkout ) {\n\t\t\t\t\t\t\twindow.latestScroll = $(document).find( \"#checkout\" ).offset().top + json.data;\n\t\t\t\t\t\t\t$('html, body').animate({scrollTop: $(document).find( \"#checkout\" ).offset().top + json.data}, 400);\n\t\t\t\t\t\t\t$('#jsLog').append('content_scroll_position: ' + json.data + '<br />');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'checkout_loaded':\n\t\t\t\t\t\t$('#jsLog').append('checkout_loaded<br />');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'hide_overlay':\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * Overlay is closed.\n\t\t\t\t\t\t */\n\t\t\t\t\t\tbco_wc.hide_overlay();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'go_to':\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * Redirect to a URL (app). JSON data includes the URL for the redirection.\n\t\t\t\t\t\t */\n\t\t\t\t\t\t location.href = json.data;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tbodyEl: $('body'),\n\t\tcheckoutFormSelector: 'form.checkout',\n\t\tshippingUpdated: false,\n\n\t\t// Order notes.\n\t\torderNotesValue: '',\n\t\torderNotesSelector: 'textarea#order_comments',\n\t\torderNotesEl: $('textarea#order_comments'),\n\n\t\t// Payment method.\n\t\tpaymentMethodEl: $('input[name=\"payment_method\"]'),\n\t\tpaymentMethod: '',\n\t\tselectAnotherSelector: '#billmate-checkout-select-other',\n\n\t\t// Address data.\n\t\taddressData: {\n\t\t\tbillingAddress: [],\n\t\t\tbillingZip: '',\n\t\t\tbillingCountry: '',\n\t\t\tshippingAddress: [],\n\t\t\tshippingZip: '',\n\t\t\tshippingCountry: '',\n\t\t\tupdateNeeded: 'no'\n\t\t},\n\n\t\t// Extra checkout fields.\n\t\tblocked: false,\n\t\textraFieldsSelectorText: 'div#bco-extra-checkout-fields input[type=\"text\"], div#bco-extra-checkout-fields input[type=\"password\"], div#bco-extra-checkout-fields textarea, div#bco-extra-checkout-fields input[type=\"email\"], div#bco-extra-checkout-fields input[type=\"tel\"]',\n\t\textraFieldsSelectorNonText: 'div#bco-extra-checkout-fields select, div#bco-extra-checkout-fields input[type=\"radio\"], div#bco-extra-checkout-fields input[type=\"checkbox\"], div#bco-extra-checkout-fields input.checkout-date-picker, input#terms input[type=\"checkbox\"]',\n\n\t\tsetBillingAddress: function(data) {\n\t\t\tvar billingZip = '';\n\t\t\tvar billingCountry = '';\n\n\t\t\t// Set billing zip and country.\n\t\t\tif ( typeof data.billingAddress === 'object' && 'zip' in data.billingAddress && '' !== data.billingAddress.zip ) { // Set billing zip and country from billingAddress object.\n\t\t\t\tbillingZip = data.billingAddress.zip;\n\t\t\t\tbillingCountry = data.billingAddress.country;\n\t\t\t\tbco_wc.addressData.billingAddress = data.billingAddress;\n\t\t\t} else if ( typeof data.Customer.Billing === 'object' && 'zip' in data.Customer.Billing && '' !== data.Customer.Billing.zip ) { // Set billing zip and country from Customer object.\n\t\t\t\tbillingZip = data.Customer.Billing.zip;\n\t\t\t\tbillingCountry = data.Customer.Billing.country;\n\t\t\t\tbco_wc.addressData.billingAddress = data.Customer.Billing;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbillingZip:billingZip,\n\t\t\t\tbillingCountry:billingCountry\n\t\t\t   }\n\n\t\t},\n\n\t\tupdateBillmateCheckout: function() {\n\t\t\t$('.woocommerce-checkout-review-order-table').block({\n\t\t\t\tmessage: null,\n\t\t\t\toverlayCSS: {\n\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\topacity: 0.6\n\t\t\t\t}\n\t\t\t});\n\t\t\t$.ajax({\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: bco_wc_params.update_checkout_url,\n\t\t\t\tdata: {\n\t\t\t\t\tnonce: bco_wc_params.update_checkout_nonce\n\t\t\t\t},\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: function(data) {\n\t\t\t\t},\n\t\t\t\terror: function(data) {\n\t\t\t\t},\n\t\t\t\tcomplete: function(data) {\n\t\t\t\t\tconsole.log(data.responseJSON);\n\t\t\t\t\tif (true === data.responseJSON.success) {\n\n\t\t\t\t\t\tif( data.responseJSON.data && data.responseJSON.data.refreshZeroAmount ) {\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbco_wc.update();\n\t\t\t\t\t\t// bco_wc.unlock();\n\t\t\t\t\t\t$('.woocommerce-checkout-review-order-table').unblock();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('error');\n\t\t\t\t\t\tif( '' !== data.responseJSON.data.redirect_url ) {\n\t\t\t\t\t\t\tconsole.log('Cart do not need payment. Reloading checkout.');\n\t\t\t\t\t\t\twindow.location.href = data.responseJSON.data.redirect_url;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tgetBillmateCheckout: function() {\n\t\t\t$.ajax({\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: bco_wc_params.get_checkout_url,\n\t\t\t\tdata: {\n\t\t\t\t\tnonce: bco_wc_params.get_checkout_nonce\n\t\t\t\t},\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: function(data) {\n\t\t\t\t},\n\t\t\t\terror: function(data) {\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tcomplete: function(data) {\n\t\t\t\t\tbco_wc.setCustomerData( data.responseJSON.data );\n\t\t\t\t\t// Check Terms checkbox, if it exists.\n\t\t\t\t\tif ($(\"form.checkout #terms\").length > 0) {\n\t\t\t\t\t\t$(\"form.checkout #terms\").prop(\"checked\", true);\n\t\t\t\t\t}\n\t\t\t\t\tbco_wc.submitForm();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tsetCustomerData: function( data ) {\n\n\t\t\t// Don't update customer data in Woo if disabled via filter.\n\t\t\tif( 'no' === bco_wc_params.populate_address_fields ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( data.billing_address !== null && data.billing_address !== undefined ) {\n\t\t\t\t// Billing fields.\n\t\t\t\t$( '#billing_first_name' ).val( ( ( 'firstname' in data.billing_address ) ? data.billing_address.firstname : '' ) );\n\t\t\t\t$( '#billing_last_name' ).val( ( ( 'lastname' in data.billing_address ) ? data.billing_address.lastname : '' ) );\n\t\t\t\t$( '#billing_company' ).val( ( ( 'company' in data.billing_address ) ? data.billing_address.company : '' ) );\n\t\t\t\t$( '#billing_address_1' ).val( ( ( 'street' in data.billing_address ) ? data.billing_address.street : '' ) );\n\t\t\t\t$( '#billing_address_2' ).val( ( ( 'street2' in data.billing_address ) ? data.billing_address.street2 : '' ) );\n\t\t\t\t$( '#billing_city' ).val( ( ( 'city' in data.billing_address ) ? data.billing_address.city : '' ) );\n\t\t\t\t$( '#billing_postcode' ).val( ( ( 'zip' in data.billing_address ) ? data.billing_address.zip : '' ) );\n\t\t\t\t$( '#billing_phone' ).val( ( ( 'phone' in data.billing_address ) ? data.billing_address.phone : '' ) );\n\t\t\t\t$( '#billing_email' ).val( ( ( 'email' in data.billing_address ) ? data.billing_address.email : '' ) );\n\t\t\t\t$( '#billing_country' ).val( ( ( 'country' in data.billing_address ) ? data.billing_address.country.toUpperCase() : '' ) );\n\t\t\t} else {\n\t\t\t\t// We did not receive a billing address from Qvickly, let's reload the checkout page an try again.\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\n\t\t\tif ( data.shipping_address !== null ) {\n\t\t\t\t$( '#ship-to-different-address-checkbox' ).prop( 'checked', true);\n\n\t\t\t\t// Shipping fields.\n\t\t\t\t// Shipping frst name. Can be returned empty.\n\t\t\t\tvar shipping_first_name = ( 'firstname' in data.shipping_address ) ? data.shipping_address.firstname : '';\n\t\t\t\tif( 0 === shipping_first_name.length) {\n\t\t\t\t\tshipping_first_name = data.billing_address.firstname;\n\t\t\t\t}\n\t\t\t\t//Shipping last name. Can be returned empty.\n\t\t\t\tvar shipping_last_name = ( 'lastname' in data.shipping_address ) ? data.shipping_address.lastname : '';\n\t\t\t\tif( 0 === shipping_last_name.length) {\n\t\t\t\t\tshipping_last_name = data.billing_address.lastname;\n\t\t\t\t}\n\t\t\t\t$( '#shipping_first_name' ).val( shipping_first_name );\n\t\t\t\t$( '#shipping_last_name' ).val( shipping_last_name );\n\t\t\t\t$( '#shipping_company' ).val( ( ( 'company' in data.shipping_address ) ? data.billing_address.company : '' ) );\n\t\t\t\t$( '#shipping_address_1' ).val( ( ( 'street' in data.shipping_address ) ? data.shipping_address.street : '' ) );\n\t\t\t\t$( '#shipping_address_2' ).val( ( ( 'street2' in data.shipping_address ) ? data.shipping_address.street2 : '' ) );\n\t\t\t\t$( '#shipping_city' ).val( ( ( 'city' in data.shipping_address ) ? data.shipping_address.city : '' ) );\n\t\t\t\t$( '#shipping_postcode' ).val( ( ( 'zip' in data.shipping_address ) ? data.shipping_address.zip : '' ) );\n\t\t\t\t$( '#shipping_country' ).val( ( ( 'country' in data.shipping_address ) ? data.shipping_address.country.toUpperCase() : '' ) );\n\t\t\t} else {\n\n\t\t\t\t$( '#shipping_first_name' ).val( ( ( 'firstname' in data.billing_address ) ? data.billing_address.firstname : '' ) );\n\t\t\t\t$( '#shipping_last_name' ).val( ( ( 'lastname' in data.billing_address ) ? data.billing_address.lastname : '' ) );\n\t\t\t\t$( '#shipping_company' ).val( ( ( 'company' in data.billing_address ) ? data.billing_address.company : '' ) );\n\t\t\t\t$( '#shipping_address_1' ).val( ( ( 'street' in data.billing_address ) ? data.billing_address.street : '' ) );\n\t\t\t\t$( '#shipping_address_2' ).val( ( ( 'street2' in data.billing_address ) ? data.billing_address.street2 : '' ) );\n\t\t\t\t$( '#shipping_city' ).val( ( ( 'city' in data.billing_address ) ? data.billing_address.city : '' ) );\n\t\t\t\t$( '#shipping_postcode' ).val( ( ( 'zip' in data.billing_address ) ? data.billing_address.zip : '' ) );\n\t\t\t\t$( '#shipping_country' ).val( ( ( 'country' in data.billing_address ) ? data.billing_address.country.toUpperCase() : '' ) );\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t* Document ready function. \n\t\t* Runs on the $(document).ready event.\n\t\t*/\n\t\tdocumentReady: function() {\n\t\t\tbco_wc.moveExtraCheckoutFields();\n\t\t},\n\n\t\t// When \"Change to another payment method\" is clicked.\n\t\tchangeFromBCO: function(e) {\n\t\t\te.preventDefault();\n\n\t\t\t$(bco_wc.checkoutFormSelector).block({\n\t\t\t\tmessage: null,\n\t\t\t\toverlayCSS: {\n\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\topacity: 0.6\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$.ajax({\n\t\t\t\ttype: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tbco: false,\n\t\t\t\t\tnonce: bco_wc_params.change_payment_method_nonce\n\t\t\t\t},\n\t\t\t\turl: bco_wc_params.change_payment_method_url,\n\t\t\t\tsuccess: function (data) {},\n\t\t\t\terror: function (data) {},\n\t\t\t\tcomplete: function (data) {\n\t\t\t\t\twindow.location.href = data.responseJSON.data.redirect;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t// When payment method is changed to BCO in regular WC Checkout page.\n\t\tmaybeChangeToBCO: function() {\n\t\t\tif ( 'bco' === $(this).val() ) {\n\n\t\t\t\t$(bco_wc.checkoutFormSelector).block({\n\t\t\t\t\tmessage: null,\n\t\t\t\t\toverlayCSS: {\n\t\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\t\topacity: 0.6\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$('.woocommerce-info').remove();\n\n\t\t\t\t$.ajax({\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tbco: true,\n\t\t\t\t\t\tnonce: bco_wc_params.change_payment_method_nonce\n\t\t\t\t\t},\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\turl: bco_wc_params.change_payment_method_url,\n\t\t\t\t\tsuccess: function (data) {},\n\t\t\t\t\terror: function (data) {},\n\t\t\t\t\tcomplete: function (data) {\n\t\t\t\t\t\twindow.location.href = data.responseJSON.data.redirect;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t* Moves all non standard fields to the extra checkout fields.\n\t\t*/\n\t\tmoveExtraCheckoutFields: function() {\n\t\t\t// Move order comments.\n\t\t\t$( '.woocommerce-additional-fields' ).appendTo( '#bco-extra-checkout-fields' );\n\n\t\t\tvar form = $( 'form[name=\"checkout\"] input, form[name=\"checkout\"] select, textarea' );\n\t\t\tfor ( i = 0; i < form.length; i++ ) {\n\t\t\t\tvar name = form[i].name.replace('[]', '\\\\[\\\\]'); // Escape any empty \"array\" keys to prevent errors.\n\n\t\t\t\t// Check if field is inside the order review.\n\t\t\t\tif( $( 'table.woocommerce-checkout-review-order-table' ).find( form[i] ).length ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Check if this is a standard field.\n\t\t\t\tif ( -1 === $.inArray( name, bco_wc_params.standard_woo_checkout_fields ) ) {\n\n\t\t\t\t\t// This is not a standard Woo field, move to our div.\n\t\t\t\t\tif ( 0 < $( 'p#' + name + '_field' ).length ) {\n\t\t\t\t\t\t$( 'p#' + name + '_field' ).appendTo( '#bco-extra-checkout-fields' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$( 'input[name=\"' + name + '\"]' ).closest( 'p' ).appendTo( '#bco-extra-checkout-fields' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t* Check if our gateway is the selected gateway.\n\t\t*/\n\t\tcheckIfSelected: function() {\n\t\t\tif (bco_wc.paymentMethodEl.length > 0) {\n\t\t\t\tbco_wc.paymentMethod = bco_wc.paymentMethodEl.filter(':checked').val();\n\t\t\t\tif( 'bco' === bco_wc.paymentMethod ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} \n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Submit the order using the WooCommerce AJAX function.\n\t\t */\n\t\tsubmitForm: function() {\n\t\t\t$( '.woocommerce-checkout-review-order-table' ).block({\n\t\t\t\tmessage: null,\n\t\t\t\toverlayCSS: {\n\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\topacity: 0.6\n\t\t\t\t}\n\t\t\t});\n\t\t\t$.ajax({\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: bco_wc_params.submit_order,\n\t\t\t\tdata: $('form.checkout').serialize(),\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: function( data ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif ( 'success' === data.result ) {\n\t\t\t\t\t\t\tbco_wc.logToFile( 'Successfully placed order. Sending bco_order_validation true to Qvickly' );\n\n\t\t\t\t\t\t\t$( 'body' ).trigger( 'bco_order_validation', true );\n\t\t\t\t\t\t\tsessionStorage.setItem( 'billmateRedirectUrl', data.redirect_url );\n\t\t\t\t\t\t\t$('form.checkout').removeClass( 'processing' ).unblock();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow 'Result failed';\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\tif ( data.messages )  {\n\t\t\t\t\t\t\tbco_wc.logToFile( 'Checkout error | ' + data.messages );\n\t\t\t\t\t\t\tbco_wc.failOrder( 'submission', data.messages );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbco_wc.logToFile( 'Checkout error | No message' );\n\t\t\t\t\t\t\tbco_wc.failOrder( 'submission', '<div class=\"woocommerce-error\">' + 'Checkout error' + '</div>' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function( data ) {\n\t\t\t\t\tbco_wc.logToFile( 'AJAX error | ' + data );\n\t\t\t\t\tbco_wc.failOrder( 'ajax-error', data );\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tfailOrder: function( event, error_message ) {\n\t\t\t// Send false and cancel.\n\t\t\tconsole.log('failOrder');\n\t\t\t$( 'body' ).trigger( 'bco_order_validation', false );\n\t\t\n\t\t\t// Re-enable the form.\n\t\t\t$( 'body' ).trigger( 'updated_checkout' );\n\t\t\t$( bco_wc.checkoutFormSelector ).unblock();\n\t\t\t$( '.woocommerce-checkout-review-order-table' ).unblock();\n\n\t\t\t// Print error messages, and trigger checkout_error, and scroll to notices.\n\t\t\t$( '.woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message' ).remove();\n\t\t\t$( 'form.checkout' ).prepend( '<div class=\"woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout\">' + error_message + '</div>' ); // eslint-disable-line max-len\n\t\t\t$( 'form.checkout' ).removeClass( 'processing' ).unblock();\n\t\t\t$( 'form.checkout' ).find( '.input-text, select, input:checkbox' ).trigger( 'validate' ).blur();\n\t\t\t$( document.body ).trigger( 'checkout_error' , [ error_message ] );\n\t\t\t$( 'html, body' ).animate( {\n\t\t\t\tscrollTop: ( $( 'form.checkout' ).offset().top - 100 )\n\t\t\t}, 1000 );\n\t\t},\n\n\t\tlogToFile: function( message ) {\n\t\t\t$.ajax(\n\t\t\t\t{\n\t\t\t\t\turl: bco_wc_params.log_to_file_url,\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmessage: message,\n\t\t\t\t\t\tnonce: bco_wc_params.log_to_file_nonce\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\tinit: function() {\n\t\t\twindow.addEventListener(\"message\", bco_wc.handleEvent);\n\t\t\t// Check if Qvickly is the selected payment method before we do anything.\n\t\t\tif( bco_wc.checkIfSelected() ) {\n\t\t\t\t$(document).ready( bco_wc.documentReady() );\n\n\t\t\t\t// Change from BCO.\n\t\t\t\tbco_wc.bodyEl.on('click', bco_wc.selectAnotherSelector, bco_wc.changeFromBCO);\n\n\t\t\t\tif ( 'checkout' === bco_wc_params.checkout_flow ) {\n\t\t\t\t\t// Update Qvickly payment.\n\t\t\t\t\tbco_wc.bodyEl.on('updated_checkout', bco_wc.updateBillmateCheckout);\n\t\t\t\t\t// Lock Qvickly on update_checkout.\n\t\t\t\t\t// bco_wc.bodyEl.on('update_checkout', bco_wc.lock);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbco_wc.bodyEl.on('change', 'input[name=\"payment_method\"]', bco_wc.maybeChangeToBCO);\n\t\t\tbco_wc.bodyEl.on( 'click', bco_wc.selectAnotherSelector, bco_wc.changeFromBCO );\n\t\t},\n\t}\n\tbco_wc.init();\n});"],"sourceRoot":""}